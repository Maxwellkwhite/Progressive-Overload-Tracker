{% include "header.html" %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>

</head>
<body>
    {% set unique_sets = [] %}
    {% for exercise in exercises %}
        {% if exercise.set_name not in unique_sets %}
            {% set _ = unique_sets.append(exercise.set_name) %}
        {% endif %}
    {% endfor %}

    <div class="mb-3">
        <label for="set-filter" class="form-label">Filter by Set:</label>
        <select id="set-filter" class="form-select" onchange="filterExercises()">
            <option value="">All Sets</option>
            {% for set_name in unique_sets %}
                <option value="{{ set_name }}">{{ set_name }}</option>
            {% endfor %}
        </select>
    </div>

    <script>
    function filterExercises() {
        const selectedSet = document.getElementById('set-filter').value;
        const exercises = document.querySelectorAll('.exercise-item');
        
        exercises.forEach(exercise => {
            if (selectedSet === '' || exercise.dataset.setName === selectedSet) {
                exercise.style.display = '';
            } else {
                exercise.style.display = 'none';
            }
        });
    }
    </script>

    <script>
    function filterExercises() {
        const selectedSet = document.getElementById('set-filter').value;
        const exercises = document.querySelectorAll('.exercise-item');
        
        exercises.forEach(exercise => {
            if (selectedSet === '' || exercise.dataset.setName === selectedSet) {
                exercise.style.display = '';
            } else {
                exercise.style.display = 'none';
            }
        });
    }
    </script>


    {% for exercise in exercises %}
    <div class="exercise-item" data-set-name="{{exercise.set_name}}">
        Exercise: {{exercise.exercise}} Set: {{exercise.set_name}} 
        <div>
            <input type="number" id="weight-{{exercise.id}}" name="weight" value="{{exercise.weight}}" onchange="updateExercise({{exercise.id}}, 'weight')">
            lbs
            <input type="number" id="reps-{{exercise.id}}" name="reps" value="{{exercise.reps}}" onchange="updateExercise({{exercise.id}}, 'reps')">
            reps
            <form action="{{ url_for('delete_exercise', id=exercise.id) }}" method="POST">
                <button type="submit" class="btn btn-primary">Delete</button>
            </form>
        </div>
    </div>
    {% endfor %}
    {{list_of_sets}}

    <script>
    function updateExercise(id, field) {
        const value = document.getElementById(`${field}-${id}`).value;
        let url;
        if (field === 'weight') {
            url = "{{url_for('weight_update', id=0)}}".replace('0', id);
        } else if (field === 'reps') {
            url = "{{url_for('reps_update', id=0)}}".replace('0', id);
        }
        fetch(url, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/x-www-form-urlencoded',
            },
            body: `${field}=${value}`
        })
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                document.getElementById(`${field}-display-${id}`).textContent = value;
            }
        });
    }
    </script>

</body>
</html>
{% include "footer.html" %}
